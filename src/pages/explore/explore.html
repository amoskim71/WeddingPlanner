<ion-header>
  <ion-navbar>
    <ion-title>
      Explore
    </ion-title>
  </ion-navbar>

  <ion-toolbar no-border-top>
    <ion-segment [(ngModel)]="vendors">
      <ion-segment-button value="explore">
        Explore
      </ion-segment-button>
      <ion-segment-button value="saved">
        Saved
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content padding="true" class="has-header">
  <div [ngSwitch]="vendors">
    <ion-list *ngSwitchDefault>
      <form action="." (ngSubmit)="search()">
        <ion-list>
          <ion-item>
            <ion-searchbar [ngModelOptions]="{standalone:true}" placeholder="Search for something" [(ngModel)]="queryString" (search)="search()"
              (ionClear)="clearSearch()">
            </ion-searchbar>
          </ion-item>
          <ion-item>
            <ion-input name="queryLocation" [(ngModel)]="queryLocation" type="text" placeholder="Using current location"></ion-input>
          </ion-item>
          <button type="submit" class="button hide"></button>
        </ion-list>
      </form>
      <ion-card *ngIf="!connected">
        <ion-item text-wrap>
          <ion-icon name="alert" item-start></ion-icon>
          <div>Could not connect to a network. Check your connection settings and try again.</div>
        </ion-item>
      </ion-card>
      <ion-list *ngFor="let vendor of (searchedVendors | async)">
        <ion-item>
          <ion-thumbnail item-start>
            <img src="{{ vendor.photoUrl }}" (click)="vendorDetails($event,vendor)">
          </ion-thumbnail>
          <h2>{{vendor.venue.name}}</h2>
          <p>{{vendor.venue.location.address}} {{ vendor.venue.price ? "(" + "$".repeat(vendor.venue.price.tier) + ")" : ""
            }}
          </p>
          <ion-icon name="{{ isSaved(vendor) ? 'heart' : 'heart-outline'}}" (click)="saveOrRemoveVendor($event,vendor)" style="font-size:32px;"
            item-end></ion-icon>
          <!-- <button ion-button clear item-end>View</button> -->
        </ion-item>
      </ion-list>
    </ion-list>
    <ion-list *ngSwitchCase="'saved'">
      <ion-list>
        <ion-item>
          <ion-label>Filter</ion-label>
          <ion-select placeholder="Select a filter" [(ngModel)]="selectedFilter" (ionChange)="filterChanged()">
            <ion-option *ngFor="let filterOpt of vendorFilterOptions" value="{{filterOpt}}">{{ filterOpt }}</ion-option>
          </ion-select>
        </ion-item>
      </ion-list>
      <ion-list *ngFor="let key of keys(savedVendors)">
        <ion-item>
          <ion-thumbnail item-start>
            <img src="{{ savedVendors[key].photoUrl }}" (click)="vendorDetails($event,savedVendors[key])">
          </ion-thumbnail>
          <h2>{{savedVendors[key].venue.name}}</h2>
          <p>{{savedVendors[key].venue.location.address}} {{ savedVendors[key].venue.price ? "(" + "$".repeat(savedVendors[key].venue.price.tier)
            + ")" : "" }}
          </p>
          <ion-icon name="{{ isSaved(savedVendors[key]) ? 'heart' : 'heart-outline'}}" (click)="saveOrRemoveVendor($event,savedVendors[key])"
            style="font-size:32px;" item-end></ion-icon>
          <!-- <button ion-button clear item-end>View</button> -->
        </ion-item>
      </ion-list>
    </ion-list>
  </div>
</ion-content>